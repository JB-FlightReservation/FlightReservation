<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.joongbu.flight_reservation.mapper.AdminMapper">

    <select id="customerList" resultType="com.joongbu.flight_reservation.dto.CustomerDto">
        SELECT * FROM CUSTOMER
    </select>
<!--    <select id="customerDetail" resultType="com.joongbu.flight_reservation.dto.CustomerDto">-->
<!--        SELECT * FROM CUSTOMER WHERE ct_name = #{ctNAME}-->
<!--    </select>-->
<!--    <update id="customerUpdate" parameterType="com.joongbu.flight_reservation.dto.CustomerDto">-->
<!--        UPDATE CUSTOMER SET ct_Name = ct_id = #{ctId}, ct_pw = #{ctPw}, #{ctName}, ct_phone = #{ctPhone}-->
<!--        , ct_email = #{ctEamil}, ct_birth = #{ctBirth} , ct_gender = #{ctGender} WHERE ct_no = #{ctNo]-->
<!--    </update>-->

</mapper>

    <resultMap type="CustomerDto" id="CustomerMap">
        <id column="ct_no" property="ctNo"/>
        <result column="ct_id" property="ctId"/>
        <result column="ct_pw" property="ctPw"/>
        <result column="ct_name" property="ctName"/>
        <result column="ct_email" property="ctEmail"/>
        <result column="ct_phone" property="ctPhone"/>
        <result column="ct_birth" property="ctBirth"/>
        <result column="ct_gender" property="ctGender"/>
        <result column="ct_create" property="ctCreate"/>
        <result column="oc_no" property="ocNo"/>
    </resultMap>
    <resultMap id="ReservationMap" type="ReservationDto">
        <id column="rv_no" property="rvNo"/>
        <result column="ct_no" property="ctNo"/>
        <result column="rv_pet_accompanying" property="rvPetAccompanying" />
        <result column="rv_phone" property="rvPhone"/>
        <result column="rv_email" property="rvEmail"/>
        <result column="rvIsTicketed" property="rvIsTicketed"/>
        <result column="rv_date" property="rvDate"/>
        <result column="rv_mature_adult" property="rvMatureAdult"/>
        <result column="rv_mature_teen" property="rvMatureTeen"/>
        <result column="rv_mature_baby" property="rvMatureBaby"/>
        <result column="rv_depart_ap" property="rvDepartAp"/>
        <result column="rv_land_ap" property="rvLandAp"/>
        <result column="next_rv_no" property="nextRvNo"/>
    </resultMap>
    <!-- 회원 관리   -->
    <select id="customerList" resultMap="CustomerMap">
        SELECT * FROM customer
        <if test="ctName!=null">
            WHERE ct_name LIKE CONCAT('%',#{ctName},'%')
        </if>
    </select>
    <update id="customerUpdate" parameterType="com.joongbu.flight_reservation.dto.CustomerDto">
        UPDATE CUSTOMER SET ct_name = #{ctName}, ct_id = #{ctId}, ct_birth = #{ctBirth}, ct_email = #{ctEmail},
        ct_phone = #{ctPhone}, ct_gender = #{ctGender} WHERE ct_no = #{ctNo}
    </update>
    <delete id="customerDelete">
        DELETE FROM CUSTOMER WHERE ct_no = #{ctNo}
    </delete>

    <!--  예약 관리  -->
    <select id="reservationList" resultMap="ReservationMap">
        SELECT * FROM reservation
        <if test="ctNo != null">
            WHERE ct_no = #{ctNo}
        </if>
    </select>

    <select id="reservationAllCount" resultMap="ReservationMap">
        SELECT COUNT(*) FROM reservation
    </select>


	<select id="login" resultType="com.joongbu.flight_reservation.dto.AdminDto">
		SELECT *,admin_id adminId from ADMIN
 		WHERE admin_id=#{adminId} AND admin_pw=#{adminPw}
	</select>
	<select id="adminDetail" resultType="com.joongbu.flight_reservation.dto.AdminDto">
		SELECT *,admin_id adminId FROM ADMIN
		WHERE admin_id=#{adminId}
	</select>
	<update id="Aupdate" parameterType="com.joongbu.flight_reservation.dto.AdminDto">
		UPDATE ADMIN SET
		admin_name=#{admin_name}, admin_pw=#{admin_pw}, admin_email=#{admin_email}, admin_no=#{admin_no}
		WHERE admin_id=#{adminId}
	</update>
</mapper>

